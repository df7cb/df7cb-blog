<?xml version="1.0" encoding="utf-8" standalone="yes"?>
<rss version="2.0" xmlns:atom="http://www.w3.org/2005/Atom">
  <channel>
    <title>Afu on Myon&#39;s Blog</title>
    <link>https://df7cb.de/blog/tags/afu.html</link>
    <description>Recent content in Afu on Myon&#39;s Blog</description>
    <generator>Hugo</generator>
    <language>en-us</language>
    <lastBuildDate>Sat, 26 Aug 2023 23:29:23 +0200</lastBuildDate>
    <atom:link href="https://df7cb.de/blog/tags/afu/index.xml" rel="self" type="application/rss+xml" />
    <item>
      <title>Getting I/Q SDR data from Icom IC-7610&#39;s USB 3 port using libftd3xx</title>
      <link>https://df7cb.de/blog/posts/2023/ic7610ftdi.html</link>
      <pubDate>Sat, 26 Aug 2023 23:29:23 +0200</pubDate>
      <guid>https://df7cb.de/blog/posts/2023/ic7610ftdi.html</guid>
      <description>&lt;p&gt;I had been looking around for some time if someone had already managed to get&#xA;I/Q data from Icom&amp;rsquo;s IC-7610 HF transceiver without going through the&#xA;binary-only hdsdr driver provided by Icom, but couldn&amp;rsquo;t find anything.&lt;/p&gt;&#xA;&lt;p&gt;First attempts at doing that on Debian Linux using libftdi1 didn&amp;rsquo;t work, so I&#xA;resorted to using the (again binary-only) libftd3xx driver from FT, and&#xA;succeeded after some tinkering around.&lt;/p&gt;&#xA;&lt;p&gt;The program writes raw I/Q data to a file in int16-int16 format.&lt;/p&gt;&#xA;&lt;ul&gt;&#xA;&lt;li&gt;ic7610ftdi: &lt;a href=&#34;https://github.com/df7cb/ic7610ftdi&#34;&gt;https://github.com/df7cb/ic7610ftdi&lt;/a&gt;&lt;/li&gt;&#xA;&lt;li&gt;Get libftd3xx from &lt;a href=&#34;https://ftdichip.com/drivers/d3xx-drivers/&#34;&gt;https://ftdichip.com/drivers/d3xx-drivers/&lt;/a&gt;&lt;/li&gt;&#xA;&lt;li&gt;IC-7610 I/Q port reference: &lt;a href=&#34;https://www.icomjapan.com/support/manual/1792/&#34;&gt;https://www.icomjapan.com/support/manual/1792/&lt;/a&gt;&lt;/li&gt;&#xA;&lt;li&gt;The IC-7610 needs to be connected using a decent USB 3 cable, preferably without any hub in-between&lt;/li&gt;&#xA;&lt;li&gt;If the SuperSpeed-FIFO Bridge disappears after some time, re-plug the cable or power-cycle the transceiver&lt;/li&gt;&#xA;&lt;/ul&gt;&#xA;&lt;pre tabindex=&#34;0&#34;&gt;&lt;code&gt;$ lsusb | grep IC&#xA;Bus 002 Device 024: ID 0c26:0029 Prolific Technology Inc. IC-7610 SuperSpeed-FIFO Bridge&#xA;&#xA;$ make&#xA;cc -Wall -g   -c -o ic7610ftdi.o ic7610ftdi.c&#xA;cc   ic7610ftdi.o  -lftd3xx -o ic7610ftdi&#xA;&#xA;$ ./ic7610ftdi iq.cs16&#xA;Device[0]&#xA;&#x9;Flags: 0x4 [USB 3] | Type: 600 | ID: 0x0C260029&#xA;&#x9;SerialNumber=23001123&#xA;&#x9;Description=IC-7610 SuperSpeed-FIFO Bridge&#xA;fe fe 98 e0 1a 0b fd ff&#xA;fe fe e0 98 1a 0b 00 fd IQ data output: 0&#xA;fe fe 98 e0 1a 0b 01 fd&#xA;fe fe e0 98 fb fd ff ff OK&#xA;RX 42 MiB ^C&#xA;fe fe 98 e0 1a 0b 00 fd&#xA;fe fe e0 98 fb fd ff ff OK&#xA;&#xA;$ ls -l iq.cs16&#xA;-rw-rw-r-- 1 myon myon 44040192 26. Aug 22:37 iq.cs16&#xA;&#xA;$ inspectrum -r 1920000 iq.cs16 &amp;amp;&#xA;&lt;/code&gt;&lt;/pre&gt;</description>
    </item>
    <item>
      <title>UDP port forwarding with iptables and ferm</title>
      <link>https://df7cb.de/blog/posts/2022/udp-portforwarding.html</link>
      <pubDate>Sun, 07 Aug 2022 23:27:52 +0200</pubDate>
      <guid>https://df7cb.de/blog/posts/2022/udp-portforwarding.html</guid>
      <description>&lt;p&gt;To talk to my IC-7610 via wireguard, I set up UDP port forwarding for ports 50001 50002 50003 on a raspi:&lt;/p&gt;&#xA;&lt;pre tabindex=&#34;0&#34;&gt;&lt;code&gt;domain (ip) {&#xA;  table filter {&#xA;    chain FORWARD {&#xA;      policy ACCEPT;&#xA;    }&#xA;  }&#xA;&#xA;  table nat {&#xA;    chain PREROUTING {&#xA;      interface (wg0) {&#xA;        proto udp dport 50001 DNAT to 192.168.0.6;&#xA;        proto udp dport 50002 DNAT to 192.168.0.6;&#xA;        proto udp dport 50003 DNAT to 192.168.0.6;&#xA;      }&#xA;    }&#xA;&#xA;    chain POSTROUTING {&#xA;      outerface (eth0) {&#xA;        proto udp dport 50001 SNAT to-source 192.168.0.3;&#xA;        proto udp dport 50002 SNAT to-source 192.168.0.3;&#xA;        proto udp dport 50003 SNAT to-source 192.168.0.3;&#xA;      }&#xA;    }&#xA;  }&#xA;}&#xA;&lt;/code&gt;&lt;/pre&gt;</description>
    </item>
    <item>
      <title>LoRa APRS iGate on TTGO LoRa32</title>
      <link>https://df7cb.de/blog/posts/2022/lora-aprs-igate.html</link>
      <pubDate>Sat, 23 Apr 2022 12:37:29 +0200</pubDate>
      <guid>https://df7cb.de/blog/posts/2022/lora-aprs-igate.html</guid>
      <description>&lt;h1 id=&#34;lora-aprs-igate&#34;&gt;LoRa APRS iGate&lt;/h1&gt;&#xA;&lt;p&gt;The official documentation of&#xA;&lt;a href=&#34;https://github.com/lora-aprs/LoRa_APRS_iGate&#34;&gt;https://github.com/lora-aprs/LoRa_APRS_iGate&lt;/a&gt;&#xA;uses the PlatformIO plugin of MS Visual Studio Code. Here are the commands to&#xA;get it running without the GUI:&lt;/p&gt;&#xA;&lt;pre tabindex=&#34;0&#34;&gt;&lt;code&gt;git clone https://github.com/lora-aprs/LoRa_APRS_iGate.git&#xA;cd LoRa_APRS_iGate&#xA;&lt;/code&gt;&lt;/pre&gt;&lt;ul&gt;&#xA;&lt;li&gt;Edit data/is-cfg.json with your station info&lt;/li&gt;&#xA;&lt;li&gt;Edit platformio.ini: &lt;code&gt;board = ttgo-lora32-v21&lt;/code&gt;&lt;/li&gt;&#xA;&lt;/ul&gt;&#xA;&lt;pre tabindex=&#34;0&#34;&gt;&lt;code&gt;pip3 install platformio&#xA;&#xA;pio run&#xA;...&#xA;Building .pio/build/lora_board/firmware.bin&#xA;...&#xA;&#xA;pio run --target upload&#xA;...&#xA;Uploading .pio/build/lora_board/firmware.bin&#xA;...&#xA;&#xA;pio run --target uploadfs&#xA;...&#xA;Building SPIFFS image from &amp;#39;data&amp;#39; directory to .pio/build/lora_board/spiffs.bin&#xA;/is-cfg.json&#xA;...&#xA;Uploading .pio/build/lora_board/spiffs.bin&#xA;...&#xA;&lt;/code&gt;&lt;/pre&gt;&lt;h1 id=&#34;lora-aprs-tracker&#34;&gt;LoRa APRS Tracker&lt;/h1&gt;&#xA;&lt;p&gt;The procedure for the tracker is the same, but the GPS module might need a&#xA;reset first:&lt;/p&gt;&#xA;&lt;pre tabindex=&#34;0&#34;&gt;&lt;code&gt;git clone https://github.com/lora-aprs/TTGO-T-Beam_GPS-reset.git&#xA;cd TTGO-T-Beam_GPS-reset&#xA;pio run -e ttgo-t-beam-v1&#xA;pio run --target upload -e ttgo-t-beam-v1&#xA;# screen /dev/ttyACM0 115200&#xA;&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;&amp;hellip; and then upload &lt;a href=&#34;https://github.com/lora-aprs/LoRa_APRS_Tracker.git&#34;&gt;https://github.com/lora-aprs/LoRa_APRS_Tracker.git&lt;/a&gt;&lt;/p&gt;</description>
    </item>
    <item>
      <title>Iambic CW keyer based on DigiSpark, MIDI, and PulseAudio on Linux</title>
      <link>https://df7cb.de/blog/posts/2022/midicwkeyer.html</link>
      <pubDate>Wed, 23 Mar 2022 18:55:11 +0100</pubDate>
      <guid>https://df7cb.de/blog/posts/2022/midicwkeyer.html</guid>
      <description>&lt;p&gt;Classic ham radio transceivers have physical connectors for morse keys and&#xA;microphones. When the transceiver is a software defined radio (SDR) device,&#xA;voice operation is easy by attaching a headset, but solutions to connect a&#xA;morse key, be it a straight key or paddles, to a modern PC are rare. In the old&#xA;times, machines had serial ports with RTS/DTR lines, but these do not exist&#xA;anymore, so a new interface is needed.&lt;/p&gt;&#xA;&lt;p&gt;I am using a LimeSDR as ground station for the QO-100 satellite, and naturally&#xA;also wanted to do CW operation there. I started with SDRangel which has a&#xA;built-in morse generator, but naturally wanted to connect a CW key. At first&#xA;sight, all the bits are there, there&amp;rsquo;s a tune button that could be used as a&#xA;straight key, as well as keyboard bindings for dots and dashes. But the delay&#xA;key-&amp;gt;local audio is almost a full second, so that&amp;rsquo;s a no-go. I then went to&#xA;hack my K3NG keyer to output ^ (high) _ (low) signals on the USB interface, and&#xA;have a smallish Python program read that and send SDRangel REST API requests.&#xA;Works, but that solution always felt &amp;ldquo;too big&amp;rdquo; to me, plus the sidetone from&#xA;the buzzer inside the Arduino case could be heard in the whole house. And the&#xA;total TX-RX delay was well over a second.&lt;/p&gt;&#xA;&lt;p&gt;Next I tried building some GNU Radio flowcharts to solve the same problem but&#xA;which all had the same trouble that the buffers grew way too big to allow the&#xA;sidetone to be used for keying. At the same time, I switched the transceiver&#xA;from SDRangel to another GR flowchart which reduced the overall TX-RX delay to&#xA;something much shorter, but the local audio delay was still too slow for CW.&lt;/p&gt;&#xA;&lt;p&gt;So after some back and forth, I came up with this solution: the external&#xA;interface from the CW paddles to the PC is a small DigiSpark board programmed&#xA;to output MIDI signals, and on the (Linux) PC side, there is a Python program&#xA;listening for MIDI and acting as a iambic CW keyer. The morse dots and dashes&#xA;are uploaded as &amp;ldquo;samples&amp;rdquo; to PulseAudio, where they are played both on the&#xA;local sidetone channel (usually headphones) and on the audio channel driving&#xA;the SDR transceiver. There is no delay. :)&lt;/p&gt;&#xA;&lt;h2 id=&#34;digispark-hardware&#34;&gt;DigiSpark hardware&lt;/h2&gt;&#xA;&lt;p&gt;The DigiSpark is a very small embedded computer that can be programmed using&#xA;the Arduino toolchain.&lt;/p&gt;&#xA;&lt;p&gt;Of the 6 IO pins, two are used for the USB bus, two connect the dit and dah&#xA;lines of the CW paddle, one connects to a potentiometer for adjusting the&#xA;keying speed, and the last one is unconnected in this design, but could be used&#xA;for keying a physical transceiver. (The onboard LED uses the this pin.)&lt;/p&gt;&#xA;&lt;pre tabindex=&#34;0&#34;&gt;&lt;code&gt;            +---------------+&#xA;            |            P5 o  -- 10k potentiometer middle pin&#xA;        =====  Attiny85  P4 o  -- USB (internal)&#xA;   USB  -----            P3 o  -- USB (internal)&#xA;        -----            P2 o  -- dah paddle&#xA;        =====   78M05    P1 o  -- (LED/TRX)&#xA;            |            P0 o  -- dit paddle&#xA;            +---o-o-o-------+&#xA;&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;There is an extra 27 kΩ resistor in the ground connection of the potentiometer&#xA;to keep the P5 voltage &amp;gt; 2.5 V, or else the DigiSpark resets. (This could be&#xA;changed by blowing some fuses, but is not necessary.)&lt;/p&gt;</description>
    </item>
    <item>
      <title>DARC Xmas Contest 2006</title>
      <link>https://df7cb.de/blog/posts/2007/darc-xmas.html</link>
      <pubDate>Sat, 17 Feb 2007 13:21:52 +0100</pubDate>
      <guid>https://df7cb.de/blog/posts/2007/darc-xmas.html</guid>
      <description>&lt;p&gt;For years, the Xmas contest has virtually been my only ham radio activity. This&#xA;year, after I had to take down the antenna in my parents&amp;rsquo; yard, I put up the&#xA;40m part of a 80/40m dipole in the attic of my flat in Saarbrücken. The first&#xA;tests were satisfying so I drove back to Saarbrücken for December 26th.&lt;/p&gt;&#xA;&lt;p&gt;&#xA;The contest started nice with a S9+50 signal from DR5S - of course DOK Q10&#xA;meant it was just very close. Unfortunately, things turned out much worse. The&#xA;antenna wasn&#39;t as matched as I had hoped and I had to put my small MFJ tuner&#xA;in. But, whatever I would tune to, the 1:1 would only withstand some second of&#xA;transmission and I had to retune. The 1:1 there would pop back up, and I had to&#xA;retune back to the original settings. GOTO 10.&#xA;&lt;p&gt;&#xA;After a bit more than one hour I gave up. The final log is here:&#xA;&lt;p&gt;&#xA;&lt;table&gt;&#xA;&lt;tr&gt;&lt;td&gt;8.33&lt;/td&gt;&lt;td&gt;3.543&lt;/td&gt;&lt;td&gt;DR5S&lt;/td&gt;&lt;td&gt;599 Q02&lt;/td&gt;&lt;td&gt;599 Q10&lt;/td&gt;&lt;/tr&gt;&#xA;&lt;tr&gt;&lt;td&gt;8.42&lt;/td&gt;&lt;td&gt;7.016&lt;/td&gt;&lt;td&gt;DL0CS&lt;/td&gt;&lt;td&gt;599 Q02&lt;/td&gt;&lt;td&gt;599 M15&lt;/td&gt;&lt;/tr&gt;&#xA;&lt;tr&gt;&lt;td&gt;8.43&lt;/td&gt;&lt;td&gt;7.016&lt;/td&gt;&lt;td&gt;G4OGD&lt;/td&gt;&lt;td&gt;599 Q02&lt;/td&gt;&lt;td&gt;599 004&lt;/td&gt;&lt;/tr&gt;&#xA;&lt;tr&gt;&lt;td&gt;8.50&lt;/td&gt;&lt;td&gt;7.013&lt;/td&gt;&lt;td&gt;OK5MM&lt;/td&gt;&lt;td&gt;599 Q02&lt;/td&gt;&lt;td&gt;599 019&lt;/td&gt;&lt;/tr&gt;&#xA;&lt;tr&gt;&lt;td&gt;9.38&lt;/td&gt;&lt;td&gt;3.545&lt;/td&gt;&lt;td&gt;DK9IP&lt;/td&gt;&lt;td&gt;599 Q02&lt;/td&gt;&lt;td&gt;599 A24&lt;/td&gt;&lt;/tr&gt;&#xA;&lt;/table&gt;&#xA;&lt;p&gt;&#xA;I don&#39;t know where the fault was, in the TRX, the tuner, or the antenna. I hope&#xA;it is not the TRX.</description>
    </item>
  </channel>
</rss>
